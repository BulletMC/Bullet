package com.aznos.packets.login.out

import com.aznos.Bullet
import com.aznos.datatypes.StringType.writeString
import com.aznos.datatypes.VarInt.writeVarInt
import com.aznos.packets.Packet

/**
 * If this packet is sent during the login phase, the client will respond with an
 * encryption response packet. Without this packet the server will run in offline mode.
 *
 * @param serverID Appears to be empty?
 * @param publicKey The servers public key in bytes
 * @param verifyToken A sequence of random bytes generated by the server
 */
class ServerEncryptionRequestPacket(
    serverID: String,
    publicKey: ByteArray,
    verifyToken: ByteArray
): Packet(0x01) {
    init {
        wrapper.writeString(serverID)
        wrapper.writeVarInt(publicKey.size)
        wrapper.write(publicKey, 0, publicKey.size)
        wrapper.writeVarInt(verifyToken.size)
        wrapper.write(verifyToken, 0, verifyToken.size)
    }
}